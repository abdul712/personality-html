# Coolify deployment configuration for PersonalitySpark
version: '3'

# Service configuration
service:
  type: static
  name: personality-spark
  
# Build configuration
build:
  # No build step needed for static site
  command: ""
  
# Environment settings
environment:
  - NODE_ENV=production
  - PORT=80
  
# Health check
health_check:
  path: /health
  interval: 30
  timeout: 10
  retries: 3
  
# Resources
resources:
  limits:
    memory: 512M
    cpu: 0.5
  requests:
    memory: 256M
    cpu: 0.25

# Networking
networking:
  # Accept connections from Cloudflare IPs only
  ingress:
    enabled: true
    annotations:
      # Cloudflare proxy support
      nginx.ingress.kubernetes.io/proxy-real-ip-cidr: "173.245.48.0/20,103.21.244.0/22,103.22.200.0/22,103.31.4.0/22,141.101.64.0/18,108.162.192.0/18,190.93.240.0/20,188.114.96.0/20,197.234.240.0/22,198.41.128.0/17,162.158.0.0/15,104.16.0.0/13,104.24.0.0/14,172.64.0.0/13,131.0.72.0/22"
      nginx.ingress.kubernetes.io/use-forwarded-headers: "true"
      
# Domains
domains:
  - personalityspark.com
  - www.personalityspark.com

# SSL Configuration
ssl:
  # Disable SSL termination at Coolify level since Cloudflare handles it
  enabled: false
  # Accept HTTP from Cloudflare (Flexible SSL mode)
  force_https: false
  
# Deployment settings
deployment:
  strategy: RollingUpdate
  replicas: 1